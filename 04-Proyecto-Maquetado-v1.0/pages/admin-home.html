<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viajes MÃ©xico - Admin</title>
    <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>Panel Admin</h1>
            <button class="profile-btn" onclick="logout()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16,17 21,12 16,7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
            </button>
        </header>

        <!-- Contenido principal -->
        <main class="main-content">
            <!-- Bienvenida -->
            <section class="section">
                <div style="background: var(--gradient-primary); color: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                    <h2 style="margin-bottom: 0.5rem;">Â¡Bienvenido, Administrador!</h2>
                    <p style="opacity: 0.9;">Gestiona productos, paquetes y transportes</p>
                </div>
            </section>

            <!-- EstadÃ­sticas generales -->
            <section class="section">
                <h2 class="section-title">EstadÃ­sticas Generales</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div style="background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; font-weight: 700; color: #0ea5e9;" id="totalProducts">0</div>
                        <div style="color: #64748b; font-size: 0.875rem;">Productos</div>
                    </div>
                    <div style="background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; font-weight: 700; color: #06b6d4;" id="totalPackages">0</div>
                        <div style="color: #64748b; font-size: 0.875rem;">Paquetes</div>
                    </div>
                    <div style="background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; font-weight: 700; color: #10b981;" id="totalUsers">0</div>
                        <div style="color: #64748b; font-size: 0.875rem;">Usuarios</div>
                    </div>
                    <div style="background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;" id="totalTransports">0</div>
                        <div style="color: #64748b; font-size: 0.875rem;">Transportes</div>
                    </div>
                </div>
            </section>

            <!-- Acciones rÃ¡pidas -->
            <section class="section">
                <h2 class="section-title">Acciones RÃ¡pidas</h2>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <button class="btn btn-large" onclick="navigateTo('admin-add')" style="width: 100%;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Agregar Producto
                    </button>
                    <button class="btn btn-large btn-secondary" onclick="navigateTo('admin-packages')" style="width: 100%;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        </svg>
                        Gestionar Paquetes
                    </button>
                    <button class="btn btn-large btn-secondary" onclick="navigateTo('admin-transport')" style="width: 100%;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M3 3h18v18H3zM9 9h6v6H9z"/>
                        </svg>
                        Gestionar Transportes
                    </button>
                </div>
            </section>

            <!-- Productos recientes -->
            <section class="section">
                <h2 class="section-title">Productos Recientes</h2>
                <div id="recentProducts">
                    <!-- Se llena dinÃ¡micamente -->
                </div>
            </section>

            <!-- Paquetes disponibles -->
            <section class="section">
                <h2 class="section-title">Paquetes Disponibles</h2>
                <div id="availablePackages">
                    <!-- Se llena dinÃ¡micamente -->
                </div>
            </section>
        </main>

        <!-- NavegaciÃ³n inferior -->
        <nav class="bottom-nav">
            <a href="#" class="nav-item active" data-nav="admin-home">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                </svg>
                <span class="nav-label">Admin</span>
            </a>
            <a href="#" class="nav-item" data-nav="admin-add">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                <span class="nav-label">Agregar</span>
            </a>
            <a href="#" class="nav-item" data-nav="admin-packages">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                </svg>
                <span class="nav-label">Paquetes</span>
            </a>
            <a href="#" class="nav-item" data-nav="admin-transport">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3h18v18H3zM9 9h6v6H9z"/>
                </svg>
                <span class="nav-label">Transporte</span>
            </a>
        </nav>
    </div>

    <script src="../assets/app.js"></script>
    <script>
        // Funciones especÃ­ficas de la pÃ¡gina admin home
        function loadAdminHomeContent() {
            loadAdminStats();
            loadRecentProducts();
            loadAvailablePackages();
        }

        function loadAdminStats() {
            // Contar productos totales
            let totalProducts = 0;
            for (const type in AppState.products) {
                totalProducts += AppState.products[type].length;
            }
            
            // Contar paquetes
            const totalPackages = AppState.packages.length;
            
            // Contar usuarios
            const totalUsers = AppState.users.length;
            
            // Contar transportes
            const totalTransports = AppState.products.transports?.length || 0;
            
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalPackages').textContent = totalPackages;
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalTransports').textContent = totalTransports;
        }

        function loadRecentProducts() {
            const container = document.getElementById('recentProducts');
            const allProducts = [];
            
            // Recopilar todos los productos
            for (const type in AppState.products) {
                AppState.products[type].forEach(product => {
                    allProducts.push({...product, type});
                });
            }
            
            // Mostrar los Ãºltimos 4 productos
            const recentProducts = allProducts.slice(-4);
            
            if (recentProducts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ðŸ“¦</div>
                        <div class="empty-state-title">No hay productos</div>
                        <div class="empty-state-text">Agrega tu primer producto</div>
                    </div>
                `;
            } else {
                container.innerHTML = recentProducts.map(product => createAdminProductCard(product)).join('');
            }
        }

        function createAdminProductCard(product) {
            return `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; padding: 1rem;">
                        <img src="${product.image}" alt="${product.name}" 
                             style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px; margin-right: 1rem;"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjMDY2NjY2Ii8+Cjx0ZXh0IHg9IjMwIiB5PSIzMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjgiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5JbWFnZW4gbm8gZGlzcG9uaWJsZTwvdGV4dD4KPC9zdmc+Cg=='">
                        <div style="flex: 1;">
                            <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.25rem;">${product.name}</h3>
                            <p style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.25rem;">${product.type}</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 0.75rem; color: #64748b;">${product.location || ''}</span>
                                <span style="font-weight: 600; color: #0ea5e9; font-size: 0.875rem;">$${product.price || 'N/A'}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAvailablePackages() {
            const container = document.getElementById('availablePackages');
            const adminPackages = AppState.packages.filter(pkg => pkg.createdBy === 'admin');
            
            if (adminPackages.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ðŸ“¦</div>
                        <div class="empty-state-title">No hay paquetes creados</div>
                        <div class="empty-state-text">Crea paquetes para los usuarios</div>
                    </div>
                `;
            } else {
                container.innerHTML = adminPackages.map(pkg => createAdminPackageCard(pkg)).join('');
            }
        }

        function createAdminPackageCard(pkg) {
            return `
                <div class="card" style="margin-bottom: 1rem;">
                    <div style="display: flex; padding: 1rem;">
                        <img src="${pkg.image}" alt="${pkg.name}" 
                             style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-right: 1rem;"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjMDY2NjY2Ii8+Cjx0ZXh0IHg9IjQwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+SW1hZ2VuIG5vIGRpc3BvbmlibGU8L3RleHQ+Cjwvc3ZnPgo='">
                        <div style="flex: 1;">
                            <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 0.25rem;">${pkg.name}</h3>
                            <p style="font-size: 0.875rem; color: #64748b; margin-bottom: 0.5rem;">${pkg.description}</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 0.875rem; color: #64748b;">${pkg.items.length} items</span>
                                <span style="font-weight: 700; color: #0ea5e9;">$${pkg.price} MXN</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Inicializar pÃ¡gina
        if (AppState.currentPage === 'admin-home') {
            loadAdminHomeContent();
        }
    </script>
</body>
</html>
